% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_otu_plots.R
\name{generate_otu_plots}
\alias{generate_otu_plots}
\title{Generate comprehensive OTU plots from selection output}
\usage{
generate_otu_plots(output, group, plot_types = NULL, otus_order = NULL)
}
\arguments{
\item{output}{List containing OTU selection results. Must include:
\itemize{
  \item `dataImp`: Imputed OTU abundance table (samples x OTUs)
  \item `OTUS`: Table with OTU information and associations
  \item `OTUSRelev`: Vector of relevant OTU names
}}

\item{group}{Vector of group labels for each sample (same length as `nrow(dataImp)`).}

\item{plot_types}{Character vector specifying which plots to generate. If `NULL`, all plots are returned.}

\item{otus_order}{Optional vector to order OTUs on axes; defaults to `OTUSRelev` order.}
}
\value{
A named list of ggplot objects corresponding to the requested plot types.
}
\description{
This function creates multiple types of plots for relevant OTUs based on the results of an OTU selection procedure.
It can generate abundance plots, CLR-transformed boxplots, relative proportion distributions, incremental AUC curves,
and PCA plots colored by original groups, k-means clusters, or hierarchical clustering.
}
\details{
The function accepts an `output` list containing the selected OTUs (`OTUSRelev`), the associated data (`dataImp`),
and the original OTU information (`OTUS`). Plots are generated without loading the packages explicitly, using
fully qualified calls (`ggplot2::`, `dplyr::`, `tidyr::`, `compositions::`, `factoextra::`).

Available plot types:
\describe{
  \item{"abundance"}{Boxplot of imputed abundances of relevant OTUs (log10 scale).}
  \item{"clr"}{Boxplot of CLR-transformed abundances for relevant OTUs.}
  \item{"proportion_violin"}{Violin plots of relative proportions by group, with mean (red) and median (blue) points.}
  \item{"proportion_density"}{Density plots of relative proportions by group, faceted by OTU.}
  \item{"proportion_bar"}{Stacked bar plots of mean OTU proportions by group.}
  \item{"auc_incremental"}{Line plot of incremental AUC when adding OTUs, with confidence intervals and labels.}
  \item{"pca_group"}{PCA plot colored by original groups with ellipses.}
  \item{"pca_kmeans"}{PCA plot colored by k-means clusters with ellipses.}
  \item{"pca_hclust"}{PCA plot colored by hierarchical clustering (Ward.D2) with ellipses.}
}
}
\examples{
\dontrun{
# Example with HIV dataset:
data(HIV)
Xnp <- model.matrix(y_HIV ~ MSM_HIV)
output1 <- LRRelev(data = x_HIV, sample = rownames(x_HIV), group = y_HIV,
  taxa = colnames(x_HIV), otus = colnames(x_HIV), cores = 2,
   X = Xnp, method = "hanley")
plots <- generate_otu_plots(output1, group=y_HIV)
plots$abundance      # Imputed abundance boxplot
plots$clr            # CLR boxplot
plots$proportion_violin # Violin plots with mean/median
plots$auc_incremental   # Incremental AUC plot
plots$pca_group         # PCA colored by group
}

}
\references{
- Wickham, H. (2016). *ggplot2: Elegant Graphics for Data Analysis*. Springer.
- Aitchison, J. (1986). *The Statistical Analysis of Compositional Data*. Chapman & Hall.
- Kassambara, A., & Mundt, F. (2020). *factoextra: Extract and Visualize the Results of Multivariate Data Analyses*. R package.
}
